# ============================================
# VN STOCK ANALYSIS SYSTEM - ENVIRONMENT VARIABLES
# ============================================

# ===== GENERAL =====
DOMAIN=localhost
ENVIRONMENT=development  # development, staging, production

# ===== N8N WORKFLOW AUTOMATION =====
N8N_USER=admin
N8N_PASSWORD=changeme_n8n_password
N8N_HOST=localhost

# ===== DATABASE (PostgreSQL) =====
POSTGRES_PASSWORD=changeme_postgres_password

# ===== REDIS =====
REDIS_PASSWORD=changeme_redis_password

# ===== AWS CREDENTIALS =====
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=ap-southeast-1
S3_BUCKET=vnstock-data

# ===== AI MODEL API KEYS =====
# Anthropic Claude API
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key

# OpenAI GPT API (optional)
OPENAI_API_KEY=sk-your-openai-key

# ===== TELEGRAM BOT =====
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
TELEGRAM_CHANNEL_ID=@vnstock_alerts
TELEGRAM_URGENT_CHANNEL_ID=@vnstock_urgent_alerts

# ===== DATA SOURCES =====
# FiinGroup API (optional - trả phí)
FIINGROUP_API_KEY=your_fiingroup_api_key
FIINGROUP_API_SECRET=your_fiingroup_secret

# VietStock API (optional)
VIETSTOCK_API_KEY=your_vietstock_api_key

# ===== SCRAPING & CRAWLING =====
# Apify (for Facebook scraping)
APIFY_API_KEY=your_apify_key

# Bright Data / Scrapy Cloud (optional)
BRIGHTDATA_API_KEY=your_brightdata_key

# ===== MONITORING (Optional) =====
GRAFANA_USER=admin
GRAFANA_PASSWORD=changeme_grafana_password

# ===== MINIO (Local S3-compatible storage for dev) =====
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=changeme_minio_password

# ===== EMAIL NOTIFICATIONS (Optional) =====
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
EMAIL_FROM=noreply@vnstock.com

# ===== RATE LIMITING =====
RATE_LIMIT_PER_HOUR=1000
RATE_LIMIT_PER_DAY=10000

# ===== FEATURE FLAGS =====
ENABLE_SOCIAL_SCRAPING=true
ENABLE_EMAIL_ALERTS=false
ENABLE_RUMOR_DETECTION=true
ENABLE_ML_FORECAST=true

# ===== SECURITY =====
JWT_SECRET_KEY=your_jwt_secret_key_change_this
API_SECRET_KEY=your_api_secret_key_change_this

# ===== LOGGING =====
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# ===== CELERY (Task Queue) =====
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

# ===== APPLICATION SETTINGS =====
APP_NAME=VN Stock Analysis
APP_VERSION=1.0.0
DEBUG=false
MAX_WORKERS=4

# ===== DATA RETENTION =====
RAW_DATA_RETENTION_DAYS=90
PROCESSED_DATA_RETENTION_DAYS=365
REPORT_RETENTION_DAYS=730

# ===== PERFORMANCE =====
MAX_CONCURRENT_ANALYSIS=5
SCRAPING_DELAY_SECONDS=2
API_TIMEOUT_SECONDS=30

# ===== VIETNAMESE MARKET SPECIFIC =====
VN_MARKET_OPEN_HOUR=9
VN_MARKET_CLOSE_HOUR=15
ANALYSIS_RUN_TIME=08:00  # Daily analysis at 8:00 AM

# ===== OPTIONAL: PREMIUM DATA SOURCES =====
# SSI API (optional)
SSI_API_KEY=
SSI_API_SECRET=

# VNDirect API (optional)
VNDIRECT_API_KEY=

# ===== BACKUP =====
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_S3_BUCKET=vnstock-backups

# ===== NOTIFICATION CHANNELS =====
# Slack (optional)
SLACK_WEBHOOK_URL=

# Discord (optional)
DISCORD_WEBHOOK_URL=

# Zalo (optional - requires Zalo OA)
ZALO_OA_ID=
ZALO_APP_ID=
ZALO_APP_SECRET=

# ===== ANTI-SPAM & FILTERING =====
SPAM_KEYWORDS=khuyến mại,đăng ký ngay,cơ hội vàng,lùa gà,pump,group vip
MIN_NEWS_QUALITY_SCORE=0.6

# ===== COMPLIANCE =====
DISCLAIMER_TEXT=Đây chỉ là thông tin tham khảo, không phải lời khuyên đầu tư
ENABLE_LEGAL_DISCLAIMER=true

# ===== CACHE SETTINGS =====
CACHE_TTL_SECONDS=300  # 5 minutes
CACHE_MARKET_DATA_TTL=60  # 1 minute for real-time data
CACHE_NEWS_TTL=600  # 10 minutes

# ===== API RATE LIMITS =====
VNSTOCK_API_RATE_LIMIT=100  # requests per hour
FIINGROUP_API_RATE_LIMIT=1000  # requests per day

# ============================================
# CRAWLING BEST PRACTICES CONFIGURATION
# ============================================

# ===== RATE LIMITING =====
CRAWL_DELAY_RSS_MS=2000  # Delay between RSS fetches (milliseconds)
CRAWL_DELAY_API_MS=2000  # Delay between API calls (milliseconds)
CRAWL_DELAY_SOCIAL_MS=6000  # Delay between social media fetches
CRAWL_MAX_CONCURRENT_SOURCES=2  # Max concurrent source fetches
CRAWL_TIMEOUT_RSS_MS=10000  # RSS fetch timeout
CRAWL_TIMEOUT_API_MS=30000  # API call timeout
CRAWL_TIMEOUT_AGENT_MS=60000  # Agent analysis timeout

# ===== RETRY CONFIGURATION =====
CRAWL_MAX_RETRIES=3  # Maximum retry attempts
CRAWL_RETRY_BACKOFF_BASE_MS=1000  # Base delay for exponential backoff
CRAWL_RETRY_BACKOFF_MAX_MS=16000  # Maximum backoff delay

# ===== DEDUPLICATION =====
DEDUP_ENABLED=true  # Enable Redis-based deduplication
DEDUP_TTL_SECONDS=604800  # 7 days TTL for dedup keys
DEDUP_KEY_PREFIX=dedup:news  # Redis key prefix

# ===== DATA VALIDATION =====
ARTICLE_MIN_TITLE_LENGTH=10  # Minimum title length
ARTICLE_MAX_TITLE_LENGTH=500  # Maximum title length
ARTICLE_MAX_AGE_DAYS=7  # Skip articles older than this

# ===== ENHANCED SPAM FILTERING =====
SPAM_KEYWORDS_EXTENDED=khuyến mại,đăng ký ngay,cơ hội vàng,click ngay,nhận quà,giảm giá sốc,miễn phí 100%,lùa gà,pump,group vip,room kín,đánh lên,chắc thắng,x2 x3,theo dõi kênh,subscribe,like share
SPAM_PATTERNS_ENABLED=true  # Enable regex spam patterns

# ===== MONITORING & METRICS =====
METRICS_ENABLED=true  # Enable Redis metrics collection
METRICS_KEY_PREFIX=metrics  # Redis key prefix for metrics
METRICS_RETENTION_DAYS=30  # How long to keep metrics

# ===== ERROR HANDLING =====
ERROR_WORKFLOW_NAME=n8n-workflow-error-handler  # Error handler workflow
ERROR_ALERT_CRITICAL=true  # Send Telegram for critical errors
ERROR_ALERT_HIGH=true  # Send Telegram for high severity errors
ERROR_DLQ_ENABLED=true  # Enable dead letter queue

# ===== INCREMENTAL CRAWLING =====
INCREMENTAL_CRAWL_ENABLED=true  # Track last crawl time
CRAWL_STATE_KEY_PREFIX=crawl  # Redis key prefix for crawl state
CRAWL_STATE_TTL_SECONDS=172800  # 2 days TTL for crawl state

# ===== ANTI-BLOCKING =====
USER_AGENT_ROTATION=true  # Rotate user agents
USER_AGENTS=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36,Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36,Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36
ACCEPT_LANGUAGE=vi-VN,vi;q=0.9,en;q=0.8
RESPECT_ROBOTS_TXT=true

# ===== S3 PARTITIONING =====
S3_PARTITION_BY_DATE=true  # Use year=/month=/day= partitioning
S3_RAW_PREFIX=raw  # Prefix for raw data
S3_PROCESSED_PREFIX=processed  # Prefix for processed data
S3_REPORTS_PREFIX=reports  # Prefix for reports
